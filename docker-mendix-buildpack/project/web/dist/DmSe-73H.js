import{m as L,h as re,aU as ce,ds as de,dt as ue,by as be,bk as ve,T as j,a6 as P,g as me,K as pe,l as fe,du as he,a9 as ge,a7 as $e,b as ye,a5 as w,t as B,a3 as xe,V as y,ad as W,ae as Oe,a8 as J,ac as je,ab as we,P as M,au as K,r as R,S as $,am as Ce,a0 as ke}from"./DTxgj959.js";import{v as Ie,d as Te}from"./D-Sagn14.js";import{l as Se,u as Ve,q as Ee,s as ze,i as Pe,z as Y,H as Me,n as Re}from"./BXK2Gcku.js";import"./DWFzDMGp.js";const Ae=L(e=>{const a=Z(e);return re(a)}),Z=e=>{const a=e.path?`${e.path}/${e.attribute}`:e.attribute,s=e.sortable&&!(mx.isOffline()&&e.path),i=e.filterable&&!(mx.isOffline()&&e.path),o=ce(e.entity,e.attribute,e.formatting??{}),l=de(a,e.dataSourceId),d=e.attributeType,f=Se(e.entity,e.attribute),x=d==="Enum"?f:void 0;return ue(l,d,function(t){const u=t.path?t.path.split("/").reverse()[0]:t.entity,b=be(u)?.attributes[t.attribute]?.isDateLocalized;return b!==void 0&&!b}(e),x),Ie(l,s),ve(l,i),{id:l,sortable:s,filterable:i,formatter:o,type:d,universe:f,isList:e.isList}},Ne=L((e,a,s,i)=>{const o=`${s}/${i}`,l=Ve(e,a,s,i,o),d=j("Parent object of association",()=>P(l.dependOn(),t=>t.object)),f=`${e.attribute}/${e.endpointEntity}`;switch(e.type){case"Reference":return x(pe(d,f,a),t=>t?.id,t=>t?[t]:[],we,(t,u)=>{const b=u.find(g=>g.id===t);return{match:b,isFullMatch:b?.id===t}});case"ReferenceSet":return x(me(d,f,a),t=>t?.map(u=>u.id)??[],t=>t??[],je,(t,u)=>{const b=t?.map(g=>u.find(C=>C.id===g)).filter(g=>g!==void 0);return{match:b??[],isFullMatch:b?.length===t?.length}})}function x(t,u,b,g,C){let k;const[Q,U]=fe("Object from setValue",void 0),A=Ee(a,e,u),[N]=a.useSlot(s,`${e.selectableObjectsId}/items`),[X]=a.useSlot(s,`${e.selectableObjectsId}/limit`),q=he(a),_=qe(o,t,e);let I=[],T=!1;const S=ge(`Referenced object of ${o}`,()=>{const n=N.dependOn()??w(),r=n.status==="loading";I=n.status==="available"?n.value:n.status==="unavailable"?[]:I,T||(T=!r);const c=Q.dependOn(),h=te.dependOn(),v=P(l.dependOn(),m=>m.attribute);if(h)return M(h);if(r&&!T)return w();if(v.status==="available"){const m=v.value,{match:p,isFullMatch:V}=C(m,I);if(V)return M(p);const E=q.dependOn();return!e.restrictToDataSource||r||y(X)===0||E?c&&J(u(c),v.value)?M(c):_.dependOn():(function(O){setTimeout(B(()=>{y(N).status==="loading"||y(q)||H(O)}))}(p),w())}return v}),D=ze(l,e,a,o),{validation$:ee,setValidation:F,invalidValue$:te}=Pe(l,D,n=>{const r=y(S);return r.status!=="available"?void 0:r.value},(n,r,c)=>A(n,r.object,c),()=>k,a,s,o),ae=$e(e.onChange.argMap,a,s),[se]=a.useSlot(ye,"form"),ne=j(`Readonly & Status value of ${o}`,()=>S.dependOn().status==="loading"?w():l.dependOn()),ie=Te(j(`Modifiable value of ${o}`,()=>{const n=S.dependOn(),r=ee.dependOn(),c=ne.dependOn(),h=c.status!=="available"||c.value.readOnly,v=c.status,m=n.status!=="available"?void 0:n.value;return{status:v,value:Object.freeze(m),type:e.type,validation:r,setValue:B(p=>v!=="available"?Y(e,s):h?Me(e,s):H(p)),readOnly:h,setValidator:p=>{k=p}}}),a,s,i);return xe(ie,n=>({value:n.value}));function H(n){const r=y(l);if(r.status!=="available")return void Y(e,s);if(n!==void 0&&!g(n))throw new W(`Value ${n} is not assignable to association of type ${e.type}.`);const c=r.value;if(b(n).some(m=>!Oe(m,e.selectableObjectsId)))throw new W(`An ObjectItem can only be passed to an association property that belongs to the same selectable objects source. ${o}`);const h=c.object,v=A(n,h,k);if(v!==void 0)F(v,n);else{const m=h.get2(e.attribute),p=u(n);(function(V,E){const O=z=>Array.isArray(z)?z.sort((oe,le)=>oe.localeCompare(le)):z;return J(O(V),O(E))})(m,p)?F(void 0,void 0):(c.object.set2(e.attribute,p??""),U(n),Re(ae,se,e.onChange,s))}}}});function qe(e,a,s){return j(`Referenced objects of ${e}`,()=>P(a.dependOn(),i=>Array.isArray(i)?i.map(o=>K(o,s.selectableObjectsId)):K(i,s.selectableObjectsId)))}const Fe=e=>{const[a,s]=R.useState(!1),i=e.source.value??e.placeholder?.value;if(!i)return $.jsx("img",{style:{display:"none"}});const o=e.alternativeText?.value??e.onClick?{tabIndex:e.tabIndex??0}:{},l={...e.alternativeText?.value?{alt:e.alternativeText.value}:{role:"presentation"},...e.onClick??e.onClickEnlarge?{role:"button"}:{},...o},d=e.width&&e.height&&G(e.width)&&G(e.height),f=e.onClickEnlarge?()=>s(!0):e.onClick?.canExecute?()=>e.onClick?.canExecute&&e.onClick.execute():void 0;return $.jsxs(R.Fragment,{children:[$.jsx("img",{className:Ce("mx-image",e.class,{"img-responsive":e.responsive}),src:i.uri,onClick:f,...l,style:{...e.style,cursor:f?"pointer":void 0,maxHeight:d?e.height:void 0,maxWidth:d?e.width:void 0,height:d?void 0:e.height,width:d?void 0:e.width}}),a?ke.createPortal($.jsx(He,{src:i.uri,alt:e.alternativeText?.value??void 0,onClick:()=>s(!1)}),document.body):null]})};function G(e){return e.endsWith("px")}const He=({src:e,alt:a,onClick:s})=>(R.useEffect(()=>{const i=window.pageYOffset;return document.getElementById("content").style.display="none",()=>{document.getElementById("content").style.display="",setTimeout(()=>window.scrollTo(0,i),0)}},[]),$.jsx("div",{className:"mx-imagezoom",onClick:s,role:"button",tabIndex:0,children:$.jsx("div",{className:"mx-imagezoom-wrapper",children:$.jsx("img",{className:"mx-imagezoom-image",src:e,alt:a})})}));export{Ae as P,Ne as V,Z as u,Fe as v};
